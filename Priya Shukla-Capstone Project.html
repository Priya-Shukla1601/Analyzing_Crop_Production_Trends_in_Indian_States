{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "f4616f85-10f1-4685-9834-9398f5300d06",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import matplotlib.pylab as plt\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "f037a48f-c67c-49ea-bd11-10679cec2826",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Crop</th>\n",
       "      <th>Crop_Year</th>\n",
       "      <th>Season</th>\n",
       "      <th>State</th>\n",
       "      <th>Area</th>\n",
       "      <th>Production</th>\n",
       "      <th>Annual_Rainfall</th>\n",
       "      <th>Fertilizer</th>\n",
       "      <th>Pesticide</th>\n",
       "      <th>Yield</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Arecanut</td>\n",
       "      <td>1997</td>\n",
       "      <td>Whole Year</td>\n",
       "      <td>Assam</td>\n",
       "      <td>73814.0</td>\n",
       "      <td>56708</td>\n",
       "      <td>2051.4</td>\n",
       "      <td>7024878.38</td>\n",
       "      <td>22882.34</td>\n",
       "      <td>0.796087</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arhar/Tur</td>\n",
       "      <td>1997</td>\n",
       "      <td>Kharif</td>\n",
       "      <td>Assam</td>\n",
       "      <td>6637.0</td>\n",
       "      <td>4685</td>\n",
       "      <td>2051.4</td>\n",
       "      <td>631643.29</td>\n",
       "      <td>2057.47</td>\n",
       "      <td>0.710435</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Castor seed</td>\n",
       "      <td>1997</td>\n",
       "      <td>Kharif</td>\n",
       "      <td>Assam</td>\n",
       "      <td>796.0</td>\n",
       "      <td>22</td>\n",
       "      <td>2051.4</td>\n",
       "      <td>75755.32</td>\n",
       "      <td>246.76</td>\n",
       "      <td>0.238333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Coconut</td>\n",
       "      <td>1997</td>\n",
       "      <td>Whole Year</td>\n",
       "      <td>Assam</td>\n",
       "      <td>19656.0</td>\n",
       "      <td>126905000</td>\n",
       "      <td>2051.4</td>\n",
       "      <td>1870661.52</td>\n",
       "      <td>6093.36</td>\n",
       "      <td>5238.051739</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Cotton(lint)</td>\n",
       "      <td>1997</td>\n",
       "      <td>Kharif</td>\n",
       "      <td>Assam</td>\n",
       "      <td>1739.0</td>\n",
       "      <td>794</td>\n",
       "      <td>2051.4</td>\n",
       "      <td>165500.63</td>\n",
       "      <td>539.09</td>\n",
       "      <td>0.420909</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19684</th>\n",
       "      <td>Small millets</td>\n",
       "      <td>1998</td>\n",
       "      <td>Kharif</td>\n",
       "      <td>Nagaland</td>\n",
       "      <td>4000.0</td>\n",
       "      <td>2000</td>\n",
       "      <td>1498.0</td>\n",
       "      <td>395200.00</td>\n",
       "      <td>1160.00</td>\n",
       "      <td>0.500000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19685</th>\n",
       "      <td>Wheat</td>\n",
       "      <td>1998</td>\n",
       "      <td>Rabi</td>\n",
       "      <td>Nagaland</td>\n",
       "      <td>1000.0</td>\n",
       "      <td>3000</td>\n",
       "      <td>1498.0</td>\n",
       "      <td>98800.00</td>\n",
       "      <td>290.00</td>\n",
       "      <td>3.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19686</th>\n",
       "      <td>Maize</td>\n",
       "      <td>1997</td>\n",
       "      <td>Kharif</td>\n",
       "      <td>Jammu and Kashmir</td>\n",
       "      <td>310883.0</td>\n",
       "      <td>440900</td>\n",
       "      <td>1356.2</td>\n",
       "      <td>29586735.11</td>\n",
       "      <td>96373.73</td>\n",
       "      <td>1.285000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19687</th>\n",
       "      <td>Rice</td>\n",
       "      <td>1997</td>\n",
       "      <td>Kharif</td>\n",
       "      <td>Jammu and Kashmir</td>\n",
       "      <td>275746.0</td>\n",
       "      <td>5488</td>\n",
       "      <td>1356.2</td>\n",
       "      <td>26242746.82</td>\n",
       "      <td>85481.26</td>\n",
       "      <td>0.016667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19688</th>\n",
       "      <td>Wheat</td>\n",
       "      <td>1997</td>\n",
       "      <td>Rabi</td>\n",
       "      <td>Jammu and Kashmir</td>\n",
       "      <td>239344.0</td>\n",
       "      <td>392160</td>\n",
       "      <td>1356.2</td>\n",
       "      <td>22778368.48</td>\n",
       "      <td>74196.64</td>\n",
       "      <td>1.261818</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>19689 rows × 10 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                Crop  Crop_Year       Season              State      Area  \\\n",
       "0           Arecanut       1997  Whole Year               Assam   73814.0   \n",
       "1          Arhar/Tur       1997  Kharif                   Assam    6637.0   \n",
       "2        Castor seed       1997  Kharif                   Assam     796.0   \n",
       "3           Coconut        1997  Whole Year               Assam   19656.0   \n",
       "4       Cotton(lint)       1997  Kharif                   Assam    1739.0   \n",
       "...              ...        ...          ...                ...       ...   \n",
       "19684  Small millets       1998  Kharif                Nagaland    4000.0   \n",
       "19685          Wheat       1998  Rabi                  Nagaland    1000.0   \n",
       "19686          Maize       1997  Kharif       Jammu and Kashmir  310883.0   \n",
       "19687           Rice       1997  Kharif       Jammu and Kashmir  275746.0   \n",
       "19688          Wheat       1997  Rabi         Jammu and Kashmir  239344.0   \n",
       "\n",
       "       Production  Annual_Rainfall   Fertilizer  Pesticide        Yield  \n",
       "0           56708           2051.4   7024878.38   22882.34     0.796087  \n",
       "1            4685           2051.4    631643.29    2057.47     0.710435  \n",
       "2              22           2051.4     75755.32     246.76     0.238333  \n",
       "3       126905000           2051.4   1870661.52    6093.36  5238.051739  \n",
       "4             794           2051.4    165500.63     539.09     0.420909  \n",
       "...           ...              ...          ...        ...          ...  \n",
       "19684        2000           1498.0    395200.00    1160.00     0.500000  \n",
       "19685        3000           1498.0     98800.00     290.00     3.000000  \n",
       "19686      440900           1356.2  29586735.11   96373.73     1.285000  \n",
       "19687        5488           1356.2  26242746.82   85481.26     0.016667  \n",
       "19688      392160           1356.2  22778368.48   74196.64     1.261818  \n",
       "\n",
       "[19689 rows x 10 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "p = pd.read_csv(r\"C:\\Users\\Lenovo\\Downloads\\crop_yield.csv.zip\")\n",
    "p"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "1adb246a-12a6-4ca8-9e78-87ee733168b3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(19689, 10)"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Reviewing data structure\n",
    "# To show number of rows and columns \n",
    "p.shape       "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "16f7214f-e61b-4e17-a293-a7465dd1c007",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['Crop', 'Crop_Year', 'Season', 'State', 'Area', 'Production',\n",
       "       'Annual_Rainfall', 'Fertilizer', 'Pesticide', 'Yield'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# To show the list of all the column names\n",
    "p.columns   "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "28b3f4f9-3756-48e7-a10f-ee9ac3f8a318",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Crop</th>\n",
       "      <th>Crop_Year</th>\n",
       "      <th>Season</th>\n",
       "      <th>State</th>\n",
       "      <th>Area</th>\n",
       "      <th>Production</th>\n",
       "      <th>Annual_Rainfall</th>\n",
       "      <th>Fertilizer</th>\n",
       "      <th>Pesticide</th>\n",
       "      <th>Yield</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Arecanut</td>\n",
       "      <td>1997</td>\n",
       "      <td>Whole Year</td>\n",
       "      <td>Assam</td>\n",
       "      <td>73814.0</td>\n",
       "      <td>56708</td>\n",
       "      <td>2051.4</td>\n",
       "      <td>7024878.38</td>\n",
       "      <td>22882.34</td>\n",
       "      <td>0.796087</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Arhar/Tur</td>\n",
       "      <td>1997</td>\n",
       "      <td>Kharif</td>\n",
       "      <td>Assam</td>\n",
       "      <td>6637.0</td>\n",
       "      <td>4685</td>\n",
       "      <td>2051.4</td>\n",
       "      <td>631643.29</td>\n",
       "      <td>2057.47</td>\n",
       "      <td>0.710435</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Castor seed</td>\n",
       "      <td>1997</td>\n",
       "      <td>Kharif</td>\n",
       "      <td>Assam</td>\n",
       "      <td>796.0</td>\n",
       "      <td>22</td>\n",
       "      <td>2051.4</td>\n",
       "      <td>75755.32</td>\n",
       "      <td>246.76</td>\n",
       "      <td>0.238333</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Coconut</td>\n",
       "      <td>1997</td>\n",
       "      <td>Whole Year</td>\n",
       "      <td>Assam</td>\n",
       "      <td>19656.0</td>\n",
       "      <td>126905000</td>\n",
       "      <td>2051.4</td>\n",
       "      <td>1870661.52</td>\n",
       "      <td>6093.36</td>\n",
       "      <td>5238.051739</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Cotton(lint)</td>\n",
       "      <td>1997</td>\n",
       "      <td>Kharif</td>\n",
       "      <td>Assam</td>\n",
       "      <td>1739.0</td>\n",
       "      <td>794</td>\n",
       "      <td>2051.4</td>\n",
       "      <td>165500.63</td>\n",
       "      <td>539.09</td>\n",
       "      <td>0.420909</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "           Crop  Crop_Year       Season  State     Area  Production  \\\n",
       "0      Arecanut       1997  Whole Year   Assam  73814.0       56708   \n",
       "1     Arhar/Tur       1997  Kharif       Assam   6637.0        4685   \n",
       "2   Castor seed       1997  Kharif       Assam    796.0          22   \n",
       "3      Coconut        1997  Whole Year   Assam  19656.0   126905000   \n",
       "4  Cotton(lint)       1997  Kharif       Assam   1739.0         794   \n",
       "\n",
       "   Annual_Rainfall  Fertilizer  Pesticide        Yield  \n",
       "0           2051.4  7024878.38   22882.34     0.796087  \n",
       "1           2051.4   631643.29    2057.47     0.710435  \n",
       "2           2051.4    75755.32     246.76     0.238333  \n",
       "3           2051.4  1870661.52    6093.36  5238.051739  \n",
       "4           2051.4   165500.63     539.09     0.420909  "
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# To preview first few rows\n",
    "p.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "74d9c374-38e8-43f0-b67b-212b671718ed",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Crop                object\n",
       "Crop_Year            int64\n",
       "Season              object\n",
       "State               object\n",
       "Area               float64\n",
       "Production           int64\n",
       "Annual_Rainfall    float64\n",
       "Fertilizer         float64\n",
       "Pesticide          float64\n",
       "Yield              float64\n",
       "dtype: object"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Reviewing data types\n",
    "p.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "36670b53-3692-474d-a032-966af06c4b56",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Crop               0\n",
       "Crop_Year          0\n",
       "Season             0\n",
       "State              0\n",
       "Area               0\n",
       "Production         0\n",
       "Annual_Rainfall    0\n",
       "Fertilizer         0\n",
       "Pesticide          0\n",
       "Yield              0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Reviewing data's missing values\n",
    "p.isnull().sum()\t"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "2a53b4ac-e6dd-4bea-abf9-282bff6619eb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Unique Crops: ['Arecanut' 'Arhar/Tur' 'Castor Seed' 'Coconut' 'Cotton(Lint)'\n",
      " 'Dry Chillies' 'Gram' 'Jute' 'Linseed' 'Maize' 'Mesta' 'Niger Seed'\n",
      " 'Onion' 'Other  Rabi Pulses' 'Potato' 'Rapeseed &Mustard' 'Rice'\n",
      " 'Sesamum' 'Small Millets' 'Sugarcane' 'Sweet Potato' 'Tapioca' 'Tobacco'\n",
      " 'Turmeric' 'Wheat' 'Bajra' 'Black Pepper' 'Cardamom' 'Coriander' 'Garlic'\n",
      " 'Ginger' 'Groundnut' 'Horse-Gram' 'Jowar' 'Ragi' 'Cashewnut' 'Banana'\n",
      " 'Soyabean' 'Barley' 'Khesari' 'Masoor' 'Moong(Green Gram)'\n",
      " 'Other Kharif Pulses' 'Safflower' 'Sannhamp' 'Sunflower' 'Urad'\n",
      " 'Peas & Beans (Pulses)' 'Other Oilseeds' 'Other Cereals' 'Cowpea(Lobia)'\n",
      " 'Oilseeds Total' 'Guar Seed' 'Other Summer Pulses' 'Moth']\n",
      "Unique States: ['Assam' 'Karnataka' 'Kerala' 'Meghalaya' 'West Bengal' 'Puducherry' 'Goa'\n",
      " 'Andhra Pradesh' 'Tamil Nadu' 'Odisha' 'Bihar' 'Gujarat' 'Madhya Pradesh'\n",
      " 'Maharashtra' 'Mizoram' 'Punjab' 'Uttar Pradesh' 'Haryana'\n",
      " 'Himachal Pradesh' 'Tripura' 'Nagaland' 'Chhattisgarh' 'Uttarakhand'\n",
      " 'Jharkhand' 'Delhi' 'Manipur' 'Jammu And Kashmir' 'Telangana'\n",
      " 'Arunachal Pradesh' 'Sikkim']\n"
     ]
    }
   ],
   "source": [
    "#Standardize crop names and state/district names \n",
    "# Cleaning crop names\n",
    "p['Crop'] = p['Crop'].str.strip()       # removes any spaces before or after the text\n",
    "p['Crop'] = p['Crop'].str.title()       # Convert to Title Case (e.g., \"rice\" → \"Rice\")\n",
    "\n",
    "# Cleaning state names\n",
    "p['State'] = p['State'].str.strip()     # Remove extra spaces\n",
    "p['State'] = p['State'].str.title()     # Convert to Title Case\n",
    "\n",
    "# Showing cleaned unique values \n",
    "print(\"Unique Crops:\", p['Crop'].unique())\n",
    "print(\"Unique States:\", p['State'].unique())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "74fdac18-576f-4b96-a781-9b9c7fc5b158",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Missing Area values: 0\n",
      "Missing Production values: 112\n",
      "After filling:\n",
      "Missing Area values: 0\n",
      "Missing Production values: 0\n"
     ]
    }
   ],
   "source": [
    "# Handle missing or anomalous production or area values\n",
    "# Treating 0 as missing in 'Area' and 'Production'\n",
    "p['Area'] = p['Area'].replace(0, np.nan)\n",
    "p['Production'] = p['Production'].replace(0, np.nan)\n",
    "\n",
    "# Showing how many values are missing now\n",
    "print(\"Missing Area values:\", p['Area'].isnull().sum())\n",
    "print(\"Missing Production values:\", p['Production'].isnull().sum())\n",
    "\n",
    "# Filling missing values using the median (can also use mean)\n",
    "p['Area'] = p['Area'].fillna(p['Area'].median())\n",
    "p['Production'] = p['Production'].fillna(p['Production'].median())\n",
    "\n",
    "# Checking again\n",
    "print(\"After filling:\")\n",
    "print(\"Missing Area values:\", p['Area'].isnull().sum())\n",
    "print(\"Missing Production values:\", p['Production'].isnull().sum())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "9b716398-90ef-42cd-a614-0478c18b69cf",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Create derived columns: \n",
    "#       o Yield if not given: Production / Area \n",
    "#       o Production per Season per State aggregated annually \n",
    "#       o Year-over-Year change (%) in production and yield \n",
    "\n",
    "# 1. Creating Yield column\n",
    "p['Yield'] = p['Production'] / p['Area']\n",
    "\n",
    "# 2. Total Production per Season per State per Year\n",
    "grouped = p.groupby(['State', 'Season', 'Crop_Year'])['Production'].sum().reset_index()\n",
    "grouped.rename(columns={'Production': 'Total_Production'}, inplace=True)\n",
    "\n",
    "# 3. Year-over-Year change (%) in Production and Yield\n",
    "p = p.sort_values(['State', 'Crop', 'Crop_Year'])\n",
    "p['Prod_Change_%'] = p.groupby(['State', 'Crop'])['Production'].pct_change() * 100\n",
    "p['Yield_Change_%'] = p.groupby(['State', 'Crop'])['Yield'].pct_change() * 100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "fa59f21b-24e5-4570-9fe4-c232b9118681",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Crop</th>\n",
       "      <th>Crop_Year</th>\n",
       "      <th>Season</th>\n",
       "      <th>State</th>\n",
       "      <th>Area</th>\n",
       "      <th>Production</th>\n",
       "      <th>Annual_Rainfall</th>\n",
       "      <th>Fertilizer</th>\n",
       "      <th>Pesticide</th>\n",
       "      <th>Yield</th>\n",
       "      <th>Prod_Change_%</th>\n",
       "      <th>Yield_Change_%</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>490</th>\n",
       "      <td>Arecanut</td>\n",
       "      <td>2000</td>\n",
       "      <td>Whole Year</td>\n",
       "      <td>Andhra Pradesh</td>\n",
       "      <td>262.0</td>\n",
       "      <td>724.0</td>\n",
       "      <td>935.6</td>\n",
       "      <td>25720.54</td>\n",
       "      <td>68.12</td>\n",
       "      <td>2.763359</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>757</th>\n",
       "      <td>Arecanut</td>\n",
       "      <td>2001</td>\n",
       "      <td>Whole Year</td>\n",
       "      <td>Andhra Pradesh</td>\n",
       "      <td>268.0</td>\n",
       "      <td>449.0</td>\n",
       "      <td>928.4</td>\n",
       "      <td>27370.84</td>\n",
       "      <td>69.68</td>\n",
       "      <td>1.675373</td>\n",
       "      <td>-37.983425</td>\n",
       "      <td>-39.371856</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1014</th>\n",
       "      <td>Arecanut</td>\n",
       "      <td>2002</td>\n",
       "      <td>Whole Year</td>\n",
       "      <td>Andhra Pradesh</td>\n",
       "      <td>296.0</td>\n",
       "      <td>427.0</td>\n",
       "      <td>648.1</td>\n",
       "      <td>28022.32</td>\n",
       "      <td>74.00</td>\n",
       "      <td>1.442568</td>\n",
       "      <td>-4.899777</td>\n",
       "      <td>-13.895744</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1220</th>\n",
       "      <td>Arecanut</td>\n",
       "      <td>2003</td>\n",
       "      <td>Whole Year</td>\n",
       "      <td>Andhra Pradesh</td>\n",
       "      <td>311.0</td>\n",
       "      <td>221.0</td>\n",
       "      <td>826.0</td>\n",
       "      <td>30782.78</td>\n",
       "      <td>74.64</td>\n",
       "      <td>0.710611</td>\n",
       "      <td>-48.243560</td>\n",
       "      <td>-50.739851</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1666</th>\n",
       "      <td>Arecanut</td>\n",
       "      <td>2005</td>\n",
       "      <td>Whole Year</td>\n",
       "      <td>Andhra Pradesh</td>\n",
       "      <td>293.0</td>\n",
       "      <td>234.0</td>\n",
       "      <td>1075.5</td>\n",
       "      <td>35136.56</td>\n",
       "      <td>61.53</td>\n",
       "      <td>0.798635</td>\n",
       "      <td>5.882353</td>\n",
       "      <td>12.387071</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14757</th>\n",
       "      <td>Wheat</td>\n",
       "      <td>2015</td>\n",
       "      <td>Rabi</td>\n",
       "      <td>West Bengal</td>\n",
       "      <td>339851.0</td>\n",
       "      <td>788503.0</td>\n",
       "      <td>1717.0</td>\n",
       "      <td>53665871.41</td>\n",
       "      <td>112150.83</td>\n",
       "      <td>2.320143</td>\n",
       "      <td>-16.050078</td>\n",
       "      <td>-17.337298</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15373</th>\n",
       "      <td>Wheat</td>\n",
       "      <td>2016</td>\n",
       "      <td>Rabi</td>\n",
       "      <td>West Bengal</td>\n",
       "      <td>321621.0</td>\n",
       "      <td>862712.0</td>\n",
       "      <td>1795.8</td>\n",
       "      <td>49288418.25</td>\n",
       "      <td>112567.35</td>\n",
       "      <td>2.682387</td>\n",
       "      <td>9.411378</td>\n",
       "      <td>15.612993</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16006</th>\n",
       "      <td>Wheat</td>\n",
       "      <td>2017</td>\n",
       "      <td>Rabi</td>\n",
       "      <td>West Bengal</td>\n",
       "      <td>117360.0</td>\n",
       "      <td>362744.0</td>\n",
       "      <td>1830.0</td>\n",
       "      <td>18477158.40</td>\n",
       "      <td>44596.80</td>\n",
       "      <td>3.090866</td>\n",
       "      <td>-57.953060</td>\n",
       "      <td>15.228178</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16641</th>\n",
       "      <td>Wheat</td>\n",
       "      <td>2018</td>\n",
       "      <td>Rabi</td>\n",
       "      <td>West Bengal</td>\n",
       "      <td>112147.0</td>\n",
       "      <td>337751.0</td>\n",
       "      <td>2012.6</td>\n",
       "      <td>18190243.40</td>\n",
       "      <td>39251.45</td>\n",
       "      <td>3.011681</td>\n",
       "      <td>-6.889983</td>\n",
       "      <td>-2.561891</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17314</th>\n",
       "      <td>Wheat</td>\n",
       "      <td>2019</td>\n",
       "      <td>Rabi</td>\n",
       "      <td>West Bengal</td>\n",
       "      <td>188308.0</td>\n",
       "      <td>509970.0</td>\n",
       "      <td>1733.4</td>\n",
       "      <td>32343782.08</td>\n",
       "      <td>69673.96</td>\n",
       "      <td>2.708170</td>\n",
       "      <td>50.989930</td>\n",
       "      <td>-10.077810</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>19689 rows × 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "           Crop  Crop_Year       Season           State      Area  Production  \\\n",
       "490    Arecanut       2000  Whole Year   Andhra Pradesh     262.0       724.0   \n",
       "757    Arecanut       2001  Whole Year   Andhra Pradesh     268.0       449.0   \n",
       "1014   Arecanut       2002  Whole Year   Andhra Pradesh     296.0       427.0   \n",
       "1220   Arecanut       2003  Whole Year   Andhra Pradesh     311.0       221.0   \n",
       "1666   Arecanut       2005  Whole Year   Andhra Pradesh     293.0       234.0   \n",
       "...         ...        ...          ...             ...       ...         ...   \n",
       "14757     Wheat       2015  Rabi            West Bengal  339851.0    788503.0   \n",
       "15373     Wheat       2016  Rabi            West Bengal  321621.0    862712.0   \n",
       "16006     Wheat       2017  Rabi            West Bengal  117360.0    362744.0   \n",
       "16641     Wheat       2018  Rabi            West Bengal  112147.0    337751.0   \n",
       "17314     Wheat       2019  Rabi            West Bengal  188308.0    509970.0   \n",
       "\n",
       "       Annual_Rainfall   Fertilizer  Pesticide     Yield  Prod_Change_%  \\\n",
       "490              935.6     25720.54      68.12  2.763359            NaN   \n",
       "757              928.4     27370.84      69.68  1.675373     -37.983425   \n",
       "1014             648.1     28022.32      74.00  1.442568      -4.899777   \n",
       "1220             826.0     30782.78      74.64  0.710611     -48.243560   \n",
       "1666            1075.5     35136.56      61.53  0.798635       5.882353   \n",
       "...                ...          ...        ...       ...            ...   \n",
       "14757           1717.0  53665871.41  112150.83  2.320143     -16.050078   \n",
       "15373           1795.8  49288418.25  112567.35  2.682387       9.411378   \n",
       "16006           1830.0  18477158.40   44596.80  3.090866     -57.953060   \n",
       "16641           2012.6  18190243.40   39251.45  3.011681      -6.889983   \n",
       "17314           1733.4  32343782.08   69673.96  2.708170      50.989930   \n",
       "\n",
       "       Yield_Change_%  \n",
       "490               NaN  \n",
       "757        -39.371856  \n",
       "1014       -13.895744  \n",
       "1220       -50.739851  \n",
       "1666        12.387071  \n",
       "...               ...  \n",
       "14757      -17.337298  \n",
       "15373       15.612993  \n",
       "16006       15.228178  \n",
       "16641       -2.561891  \n",
       "17314      -10.077810  \n",
       "\n",
       "[19689 rows x 12 columns]"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "p"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "76b5decf-54a7-4062-882e-747153d7b568",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
